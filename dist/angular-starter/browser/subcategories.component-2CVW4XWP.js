import{a as pt}from"./chunk-MMUWIWQP.js";import{a as he,b as ve,c as Me,d as Ie,e as Qe,f as ze}from"./chunk-5HKDVOZW.js";import{a as Le}from"./chunk-JGDGZY6W.js";import{b as ut,c as _t}from"./chunk-N3DUFGH4.js";import{b as lt,c as ct}from"./chunk-LNA6J5UG.js";import{a as b,b as Ue,c as Oe,d as He,e as $e,f as je}from"./chunk-7GDRIGFI.js";import{a as Je,b as We,c as Ge,d as Ke,e as Xe,f as Ye,g as Ze,h as et,i as tt,j as it,k as at}from"./chunk-PPHCUSVG.js";import{a as Ve}from"./chunk-V3YCIJYQ.js";import{a as st,b as mt,c as dt,g as gt}from"./chunk-LAF373ZA.js";import"./chunk-JURKDGMK.js";import{$ as qe,B as we,D as L,G as Y,H as Te,L as Ee,M as ke,O as De,P as Fe,T as Ae,V as Ne,W as Pe,X as Re,_ as Z,ea as ee,ha as te,ia as Be,ja as ie,na as nt,ra as ot,sa as rt}from"./chunk-7M6NR5Y6.js";import{a as B,b as Q,c as z,f as J,h as W}from"./chunk-277XKCPD.js";import{h as Se,i as j,l as ye,ma as Ce,n as q,oa as G,pa as K,qa as X,ra as xe}from"./chunk-JMDSQALO.js";import{Bc as oe,Dc as re,Fb as V,Fc as $,Kc as M,Lb as s,Mb as o,Nb as r,Ob as h,Pb as S,Qb as y,Sb as C,Xb as u,Ya as me,Yb as d,_a as c,a as k,ac as de,b as R,ba as se,bc as ge,cc as ue,eb as U,ga as w,gc as x,hc as H,ic as ne,lb as O,lc as l,ma as _,mc as T,na as p,nc as D,pc as _e,qc as pe,rb as g,rc as fe,sc as be}from"./chunk-ZH2ICRTR.js";var yt={subcategories:[],initialized:!1,error:null,currentPage:1,pageSize:10,searchQuery:"",isLoading:!1,sortField:null,sortDirection:"asc",selectedCategoryId:null},ft=Ue({providedIn:"root"},je(yt),Oe(({subcategories:t,searchQuery:a,currentPage:e,pageSize:i,isLoading:n,error:m,sortField:f,sortDirection:v,selectedCategoryId:E})=>{let ae=M(()=>{let F=t().filter(I=>(E()===null||I.categoryId===E())&&(String(I.name||"").toLowerCase().includes(a().toLowerCase())||String(I.icon||"").toLowerCase().includes(a().toLowerCase())||String(I.comments||"").toLowerCase().includes(a().toLowerCase())||String(I.CategoryName||"").toLowerCase().includes(a().toLowerCase())));return f()&&(F=F.sort((I,ce)=>{let A=f();if(A==="createdAt"||A==="modifiedAt"){let N=new Date(I[A]||"").getTime(),P=new Date(ce[A]||"").getTime();return v()==="asc"?N-P:P-N}else{let N=String(I[A]||"").toLowerCase(),P=String(ce[A]||"").toLowerCase();return v()==="asc"?N.localeCompare(P):P.localeCompare(N)}})),F});return{subcategories:M(()=>t()),filteredSubcategories:ae,paginatedSubcategories:M(()=>{let F=(e()-1)*i();return ae().slice(F,F+i())}),totalPages:M(()=>Math.ceil(ae().length/i())),currentPage:M(()=>e()),pageSize:M(()=>i()),isLoading:M(()=>n()),error:M(()=>m()),selectedCategoryId:M(()=>E())}}),$e(t=>({loadSubcategories(){try{b(t,{isLoading:!0,error:null});let a=localStorage.getItem("subcategories"),e=[];a&&(e=JSON.parse(a).map(i=>R(k({},i),{name:String(i.name||""),icon:String(i.icon||""),imageUrl:String(i.imageUrl||""),createdAt:String(i.createdAt||new Date().toISOString()),modifiedAt:String(i.modifiedAt||new Date().toISOString()),comments:String(i.comments||""),CategoryName:String(i.CategoryName||""),categoryId:Number(i.categoryId||0)}))),b(t,{subcategories:e,initialized:!0,isLoading:!1,error:null})}catch(a){let e=a.message||"Failed to load subcategories";throw b(t,{error:e,isLoading:!1}),a}},addSubcategory(a){try{b(t,{isLoading:!0,error:null});let e=R(k({},a),{id:Date.now(),createdAt:new Date().toISOString(),modifiedAt:new Date().toISOString(),name:String(a.name||""),icon:String(a.icon||""),imageUrl:String(a.imageUrl||""),comments:String(a.comments||""),CategoryName:String(a.CategoryName||""),categoryId:Number(a.categoryId||0)}),i=localStorage.getItem("subcategories"),n=i?JSON.parse(i):[];return n.push(e),localStorage.setItem("subcategories",JSON.stringify(n)),b(t,{subcategories:[...t.subcategories(),e],isLoading:!1,error:null}),e}catch(e){let i=e.message||"Failed to add subcategory";throw b(t,{error:i,isLoading:!1}),e}},updateSubcategory(a){try{b(t,{isLoading:!0,error:null});let e=localStorage.getItem("subcategories");if(e){let n=JSON.parse(e).map(m=>m.id===a.id?R(k({},a),{modifiedAt:new Date().toISOString(),name:String(a.name||""),icon:String(a.icon||""),imageUrl:String(a.imageUrl||""),comments:String(a.comments||""),CategoryName:String(a.CategoryName||""),categoryId:Number(a.categoryId||0)}):m);localStorage.setItem("subcategories",JSON.stringify(n)),b(t,{subcategories:t.subcategories().map(m=>m.id===a.id?R(k({},a),{modifiedAt:new Date().toISOString(),name:String(a.name||""),icon:String(a.icon||""),imageUrl:String(a.imageUrl||""),comments:String(a.comments||""),CategoryName:String(a.CategoryName||""),categoryId:Number(a.categoryId||0)}):m),isLoading:!1,error:null})}}catch(e){let i=e.message||"Failed to update subcategory";throw b(t,{error:i,isLoading:!1}),e}},deleteSubcategory(a){try{b(t,{isLoading:!0,error:null});let e=localStorage.getItem("subcategories");if(e){let n=JSON.parse(e).filter(m=>m.id!==a);localStorage.setItem("subcategories",JSON.stringify(n)),b(t,{subcategories:t.subcategories().filter(m=>m.id!==a),isLoading:!1,error:null})}}catch(e){let i=e.message||"Failed to delete subcategory";throw b(t,{error:i,isLoading:!1}),e}},setPage(a){b(t,{currentPage:a})},setPageSize(a){b(t,{pageSize:a,currentPage:1})},setSearchQuery(a){b(t,{searchQuery:a,currentPage:1})},sortSubcategories(a,e){b(t,{sortField:a,sortDirection:e,currentPage:1})},setSelectedCategoryId(a){b(t,{selectedCategoryId:a,currentPage:1})}})),He({onInit(t){t.loadSubcategories()}}));var St=(()=>{class t{subcategoryStore=w(ft);subcategories=this.subcategoryStore.subcategories;filteredSubcategories=this.subcategoryStore.filteredSubcategories;paginatedSubcategories=this.subcategoryStore.paginatedSubcategories;totalPages=this.subcategoryStore.totalPages;currentPage=this.subcategoryStore.currentPage;pageSize=this.subcategoryStore.pageSize;isLoading=this.subcategoryStore.isLoading;error=this.subcategoryStore.error;selectedCategoryId=this.subcategoryStore.selectedCategoryId;getSubcategories(){return this.subcategoryStore.loadSubcategories()}addSubcategory(e){return this.subcategoryStore.addSubcategory(e)}updateSubcategory(e){return this.subcategoryStore.updateSubcategory(e)}deleteSubcategory(e){return this.subcategoryStore.deleteSubcategory(e)}setPage(e){this.subcategoryStore.setPage(e)}setPageSize(e){this.subcategoryStore.setPageSize(e)}setSearchQuery(e){this.subcategoryStore.setSearchQuery(e)}sortSubcategories(e,i){this.subcategoryStore.sortSubcategories(e,i)}setSelectedCategoryId(e){this.subcategoryStore.setSelectedCategoryId(e)}static \u0275fac=function(i){return new(i||t)};static \u0275prov=se({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function It(t,a){t&1&&(o(0,"mat-error"),l(1," Subcategory Name is required "),r())}function wt(t,a){t&1&&(o(0,"mat-error"),l(1," Icon is required "),r())}function Tt(t,a){t&1&&(o(0,"mat-error"),l(1," Image URL is required "),r())}var le=(()=>{class t{fb;dialogRef;data;subcategoryForm;constructor(e,i,n={}){this.fb=e,this.dialogRef=i,this.data=n,this.subcategoryForm=this.fb.group({name:["",L.required],icon:["",L.required],imageUrl:["",L.required],comments:[""],categoryId:[this.data?.categoryId||0,L.required],CategoryName:[this.data?.CategoryName||""]})}ngOnInit(){this.data?.subcategory&&this.subcategoryForm.patchValue(this.data.subcategory)}saveSubcategory(){if(this.subcategoryForm.invalid){this.subcategoryForm.markAllAsTouched();return}this.dialogRef.close(this.subcategoryForm.value)}cancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||t)(U(Ne),U(st),U(mt))};static \u0275cmp=O({type:t,selectors:[["app-add-subcategories"]],decls:46,vars:9,consts:[[1,"p-6","bg-white","dark:bg-gray-800","shadow-3xl","rounded-lg"],[1,"absolute","top-0","right-0","flex","justify-center","items-center","p-2","rounded-full","hover:bg-gray-100",3,"click"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-gray-900","dark:text-gray-100",2,"font-family","'Roboto, sans-serif'"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-2","gap-4"],[1,"flex","flex-col","min-h-[6rem]"],["matInput","","disabled","","placeholder","Category Name",3,"value"],["matInput","","formControlName","name","required","","placeholder","Subcategory Name"],[4,"ngIf"],["matInput","","formControlName","icon","required","","placeholder","Material Icon Name (e.g., star)"],["matInput","","formControlName","imageUrl","required","","placeholder","Image URL"],[1,"flex","flex-col","min-h-[6rem]","col-span-2"],["matInput","","formControlName","comments","placeholder","Comments"],["type","hidden","formControlName","categoryId"],["type","hidden","formControlName","CategoryName"],[1,"mt-4","flex","justify-end","gap-2"],["mat-button","","type","button","aria-label","Cancel subcategory form",1,"bg-gray-300","text-gray-800","px-4","py-2","rounded-lg","hover:bg-gray-400","transition",2,"font-family","'Roboto, sans-serif'",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"hover:bg-blue-700","transition",2,"font-family","'Roboto, sans-serif'",3,"disabled"]],template:function(i,n){if(i&1&&(o(0,"mat-card",0)(1,"mat-card-header")(2,"button",1),u("click",function(){return n.cancel()}),o(3,"mat-icon"),l(4,"close"),r()(),o(5,"mat-card-title",2)(6,"h2",3),l(7),r()()(),o(8,"mat-card-content")(9,"form",4),u("ngSubmit",function(){return n.saveSubcategory()}),o(10,"div",5)(11,"div",6)(12,"mat-form-field")(13,"mat-label"),l(14,"Category"),r(),h(15,"input",7),r()(),o(16,"div",6)(17,"mat-form-field")(18,"mat-label"),l(19,"Name"),r(),h(20,"input",8),g(21,It,2,0,"mat-error",9),r()(),o(22,"div",6)(23,"mat-form-field")(24,"mat-label"),l(25,"Icon"),r(),h(26,"input",10),g(27,wt,2,0,"mat-error",9),r()(),o(28,"div",6)(29,"mat-form-field")(30,"mat-label"),l(31,"Image URL"),r(),h(32,"input",11),g(33,Tt,2,0,"mat-error",9),r()(),o(34,"div",12)(35,"mat-form-field")(36,"mat-label"),l(37,"Comments"),r(),h(38,"input",13),r()(),h(39,"input",14)(40,"input",15),r(),o(41,"div",16)(42,"button",17),u("click",function(){return n.cancel()}),l(43," Cancel "),r(),o(44,"button",18),l(45),r()()()()()),i&2){let m,f,v;c(7),D(" ",n.data!=null&&n.data.subcategory?"Edit Subcategory":"Add Subcategory"," "),c(2),s("formGroup",n.subcategoryForm),c(6),s("value",(n.data==null?null:n.data.CategoryName)||""),c(6),s("ngIf",((m=n.subcategoryForm.get("name"))==null?null:m.hasError("required"))&&((m=n.subcategoryForm.get("name"))==null?null:m.touched)),c(6),s("ngIf",((f=n.subcategoryForm.get("icon"))==null?null:f.hasError("required"))&&((f=n.subcategoryForm.get("icon"))==null?null:f.touched)),c(6),s("ngIf",((v=n.subcategoryForm.get("imageUrl"))==null?null:v.hasError("required"))&&((v=n.subcategoryForm.get("imageUrl"))==null?null:v.touched)),c(11),s("disabled",n.subcategoryForm.invalid),V("aria-label",n.data!=null&&n.data.subcategory?"Update subcategory":"Save subcategory"),c(),D(" ",n.data!=null&&n.data.subcategory?"Update":"Save"," ")}},dependencies:[q,j,Re,ke,we,Y,Te,Ae,De,Fe,K,G,xe,X,te,ee,Z,qe,ie,Be,W,B,z,J,Q],encapsulation:2})}return t})();function Et(t,a){if(t&1&&(o(0,"mat-option",11),l(1),r()),t&2){let e=a.$implicit;s("value",e.id),c(),T(e.name)}}function kt(t,a){if(t&1&&(o(0,"div",25),l(1),r()),t&2){let e=d();c(),D(" Error: ",e.service.error(),". Please try again or contact support. ")}}function Dt(t,a){t&1&&(o(0,"div",26),h(1,"mat-spinner",27),r())}function Ft(t,a){if(t&1){let e=C();o(0,"mat-header-cell",56)(1,"mat-checkbox",57),u("change",function(n){_(e);let m=d(3);return p(m.toggleAllSubcategories(n.checked))}),r()()}if(t&2){let e=d(3);c(),s("checked",e.isAllSelected())("indeterminate",e.selectedSubcategories.length>0&&!e.isAllSelected())}}function At(t,a){if(t&1){let e=C();o(0,"mat-cell",56)(1,"mat-checkbox",58),u("change",function(){let n=_(e).$implicit,m=d(3);return p(m.toggleSubcategory(n))}),r()()}if(t&2){let e=a.$implicit,i=d(3);c(),s("checked",i.isSelected(e))}}function Nt(t,a){t&1&&(S(0,53),g(1,Ft,2,2,"mat-header-cell",54)(2,At,2,1,"mat-cell",55),y())}function Pt(t,a){if(t&1&&(o(0,"button",62)(1,"mat-icon",63),l(2,"sort"),r()()),t&2){d();let e=x(5);s("matMenuTriggerFor",e)}}function Rt(t,a){if(t&1&&(o(0,"button",62)(1,"mat-icon",63),l(2,"sort"),r()()),t&2){d();let e=x(5);s("matMenuTriggerFor",e)}}function Vt(t,a){if(t&1){let e=C();o(0,"mat-header-cell",59),l(1," Name "),g(2,Pt,3,1,"button",60)(3,Rt,3,1,"button",60),o(4,"mat-menu",null,1)(6,"button",61),u("click",function(){_(e);let n=d(2);return p(n.sortColumn("name","asc"))}),l(7,"Ascending"),r(),o(8,"button",61),u("click",function(){_(e);let n=d(2);return p(n.sortColumn("name","desc"))}),l(9,"Descending"),r()()()}if(t&2){let e=d(2);c(2),s("ngIf",e.sortField==="name"),c(),s("ngIf",e.sortField!=="name")}}function Lt(t,a){if(t&1&&(o(0,"mat-cell",64),l(1),r()),t&2){let e=a.$implicit;c(),T(e.name)}}function Ut(t,a){t&1&&(o(0,"mat-header-cell",65),l(1,"Icon"),r())}function Ot(t,a){if(t&1&&(o(0,"mat-cell",65)(1,"mat-icon"),l(2),r()()),t&2){let e=a.$implicit;c(2),T(e.icon)}}function Ht(t,a){t&1&&(o(0,"mat-header-cell",69),l(1,"Image"),r())}function $t(t,a){if(t&1&&h(0,"img",71),t&2){let e=d().$implicit;s("src",e.imageUrl,me)}}function jt(t,a){if(t&1&&(o(0,"mat-cell",69),g(1,$t,1,1,"img",70),r()),t&2){let e=a.$implicit;c(),s("ngIf",e.imageUrl)}}function qt(t,a){t&1&&(S(0,66),g(1,Ht,2,0,"mat-header-cell",67)(2,jt,2,1,"mat-cell",68),y())}function Bt(t,a){if(t&1&&(o(0,"button",77)(1,"mat-icon",63),l(2,"sort"),r()()),t&2){d();let e=x(5);s("matMenuTriggerFor",e)}}function Qt(t,a){if(t&1&&(o(0,"button",77)(1,"mat-icon",63),l(2,"sort"),r()()),t&2){d();let e=x(5);s("matMenuTriggerFor",e)}}function zt(t,a){if(t&1){let e=C();o(0,"mat-header-cell",75),l(1," Category "),g(2,Bt,3,1,"button",76)(3,Qt,3,1,"button",76),o(4,"mat-menu",null,2)(6,"button",61),u("click",function(){_(e);let n=d(3);return p(n.sortColumn("CategoryName","asc"))}),l(7,"Ascending"),r(),o(8,"button",61),u("click",function(){_(e);let n=d(3);return p(n.sortColumn("CategoryName","desc"))}),l(9,"Descending"),r()()()}if(t&2){let e=d(3);c(2),s("ngIf",e.sortField==="CategoryName"),c(),s("ngIf",e.sortField!=="CategoryName")}}function Jt(t,a){if(t&1&&(o(0,"mat-cell",78),l(1),r()),t&2){let e=a.$implicit;c(),T(e.CategoryName)}}function Wt(t,a){t&1&&(S(0,72),g(1,zt,10,2,"mat-header-cell",73)(2,Jt,2,1,"mat-cell",74),y())}function Gt(t,a){if(t&1&&(o(0,"button",84)(1,"mat-icon",63),l(2,"sort"),r()()),t&2){d();let e=x(5);s("matMenuTriggerFor",e)}}function Kt(t,a){if(t&1&&(o(0,"button",84)(1,"mat-icon",63),l(2,"sort"),r()()),t&2){d();let e=x(5);s("matMenuTriggerFor",e)}}function Xt(t,a){if(t&1){let e=C();o(0,"mat-header-cell",82),l(1," Created At "),g(2,Gt,3,1,"button",83)(3,Kt,3,1,"button",83),o(4,"mat-menu",null,3)(6,"button",61),u("click",function(){_(e);let n=d(3);return p(n.sortColumn("createdAt","asc"))}),l(7,"Ascending"),r(),o(8,"button",61),u("click",function(){_(e);let n=d(3);return p(n.sortColumn("createdAt","desc"))}),l(9,"Descending"),r()()()}if(t&2){let e=d(3);c(2),s("ngIf",e.sortField==="createdAt"),c(),s("ngIf",e.sortField!=="createdAt")}}function Yt(t,a){if(t&1&&(o(0,"mat-cell",85),l(1),oe(2,"date"),r()),t&2){let e=a.$implicit;c(),T(re(2,1,e.createdAt,"short"))}}function Zt(t,a){t&1&&(S(0,79),g(1,Xt,10,2,"mat-header-cell",80)(2,Yt,3,4,"mat-cell",81),y())}function ei(t,a){if(t&1&&(o(0,"button",91)(1,"mat-icon",63),l(2,"sort"),r()()),t&2){d();let e=x(5);s("matMenuTriggerFor",e)}}function ti(t,a){if(t&1&&(o(0,"button",91)(1,"mat-icon",63),l(2,"sort"),r()()),t&2){d();let e=x(5);s("matMenuTriggerFor",e)}}function ii(t,a){if(t&1){let e=C();o(0,"mat-header-cell",89),l(1," Updated At "),g(2,ei,3,1,"button",90)(3,ti,3,1,"button",90),o(4,"mat-menu",null,4)(6,"button",61),u("click",function(){_(e);let n=d(3);return p(n.sortColumn("modifiedAt","asc"))}),l(7,"Ascending"),r(),o(8,"button",61),u("click",function(){_(e);let n=d(3);return p(n.sortColumn("modifiedAt","desc"))}),l(9,"Descending"),r()()()}if(t&2){let e=d(3);c(2),s("ngIf",e.sortField==="modifiedAt"),c(),s("ngIf",e.sortField!=="modifiedAt")}}function ai(t,a){if(t&1&&(o(0,"mat-cell",92),l(1),oe(2,"date"),r()),t&2){let e=a.$implicit;c(),T(re(2,1,e.modifiedAt,"short"))}}function ni(t,a){t&1&&(S(0,86),g(1,ii,10,2,"mat-header-cell",87)(2,ai,3,4,"mat-cell",88),y())}function oi(t,a){t&1&&(o(0,"mat-header-cell",96),l(1,"Comments"),r())}function ri(t,a){if(t&1&&(o(0,"mat-cell",96),l(1),r()),t&2){let e=a.$implicit;c(),T(e.comments)}}function li(t,a){t&1&&(S(0,93),g(1,oi,2,0,"mat-header-cell",94)(2,ri,2,1,"mat-cell",95),y())}function ci(t,a){if(t&1){let e=C();o(0,"mat-header-cell",97),l(1," Actions "),o(2,"button",98),u("click",function(){_(e);let n=d(2);return p(n.refreshTable())}),o(3,"mat-icon",63),l(4,"refresh"),r()()()}}function si(t,a){if(t&1){let e=C();S(0),o(1,"button",100),u("click",function(){_(e);let n=d().$implicit,m=d(2);return p(m.startEdit(n))}),o(2,"mat-icon"),l(3,"edit"),r()(),o(4,"button",101),u("click",function(){_(e);let n=d().$implicit,m=d(2);return p(m.service.deleteSubcategory(n.id))}),o(5,"mat-icon"),l(6,"delete"),r()(),y()}}function mi(t,a){if(t&1){let e=C();o(0,"button",102)(1,"mat-icon"),l(2,"more_vert"),r()(),o(3,"mat-menu",null,6)(5,"button",103),u("click",function(){_(e);let n=d().$implicit,m=d(2);return p(m.startEdit(n))}),o(6,"mat-icon"),l(7,"edit"),r(),l(8," Edit "),r(),o(9,"button",104),u("click",function(){_(e);let n=d().$implicit,m=d(2);return p(m.service.deleteSubcategory(n.id))}),o(10,"mat-icon"),l(11,"delete"),r(),l(12," Delete "),r()()}if(t&2){let e=x(4);s("matMenuTriggerFor",e)}}function di(t,a){if(t&1&&(o(0,"mat-cell",99),g(1,si,7,0,"ng-container",51)(2,mi,13,1,"ng-template",null,5,$),r()),t&2){let e=x(3),i=d(2);c(),s("ngIf",!i.isMobile)("ngIfElse",e)}}function gi(t,a){t&1&&h(0,"mat-header-row",105)}function ui(t,a){if(t&1&&h(0,"mat-row",106),t&2){let e=a.$implicit;V("aria-label","Subcategory row "+e.id)}}function _i(t,a){if(t&1){let e=C();o(0,"button",108),u("click",function(){let n=_(e).$implicit,m=d(4);return p(m.onPageChange({page:n}))}),l(1),r()}if(t&2){let e=a.$implicit,i=d(4);H("color",i.service.currentPage()===e?"var(--mat-sys-on-primary)":"var(--mat-sys-on-surface)")("background-color",i.service.currentPage()===e?"var(--mat-sys-primary)":"transparent"),ne("bg-blue-600",i.service.currentPage()===e),V("aria-label","Page "+e),c(),D(" ",e," ")}}function pi(t,a){if(t&1&&(S(0),g(1,_i,2,8,"button",107),y()),t&2){let e=d(3);c(),s("ngForOf",e.getPageNumbers())}}function fi(t,a){t&1&&(o(0,"span",109),l(1,"No pages available"),r())}function bi(t,a){if(t&1&&(S(0),g(1,pi,2,1,"ng-container",51)(2,fi,2,0,"ng-template",null,7,$),y()),t&2){let e=x(3),i=d(2);c(),s("ngIf",i.getPageNumbers().length>0)("ngIfElse",e)}}function Si(t,a){if(t&1&&(o(0,"mat-option",11),l(1),r()),t&2){let e=a.$implicit;s("value",e),c(),D(" ",e," ")}}function yi(t,a){t&1&&(o(0,"mat-option",112),l(1,"No pages available"),r())}function Ci(t,a){if(t&1){let e=C();o(0,"mat-select",110),u("selectionChange",function(n){_(e);let m=d(2);return p(m.onPageChange({page:n.value}))}),g(1,Si,2,2,"mat-option",12)(2,yi,2,0,"mat-option",111),r()}if(t&2){let e=d(2);s("value",e.service.currentPage()),c(),s("ngForOf",e.getPageNumbers()),c(),s("ngIf",e.getPageNumbers().length===0)}}function xi(t,a){if(t&1){let e=C();o(0,"div",28)(1,"mat-table",29),g(2,Nt,3,0,"ng-container",30),S(3,31),g(4,Vt,10,2,"mat-header-cell",32)(5,Lt,2,1,"mat-cell",33),y(),S(6,34),g(7,Ut,2,0,"mat-header-cell",35)(8,Ot,3,1,"mat-cell",36),y(),g(9,qt,3,0,"ng-container",37)(10,Wt,3,0,"ng-container",38)(11,Zt,3,0,"ng-container",39)(12,ni,3,0,"ng-container",40)(13,li,3,0,"ng-container",41),S(14,42),g(15,ci,5,0,"mat-header-cell",43)(16,di,4,2,"mat-cell",44),y(),g(17,gi,1,0,"mat-header-row",45)(18,ui,1,1,"mat-row",46),r(),o(19,"div",47)(20,"span",48),l(21),r(),o(22,"div",49)(23,"button",50),u("click",function(){_(e);let n=d();return p(n.onPageChange({page:n.service.currentPage()-1}))}),l(24," Previous "),r(),g(25,bi,4,2,"ng-container",51)(26,Ci,3,3,"ng-template",null,0,$),o(28,"button",52),u("click",function(){_(e);let n=d();return p(n.onPageChange({page:n.service.currentPage()+1}))}),l(29," Next "),r()()()()}if(t&2){let e=x(27),i=d();ne("dark-theme",i.darkModeService.isDarkMode()),c(),s("dataSource",i.service.paginatedSubcategories()),c(),s("ngIf",!i.isMobile),c(7),s("ngIf",!i.isMobile),c(),s("ngIf",!i.isMobile),c(),s("ngIf",i.responsive.isDesktop()),c(),s("ngIf",i.responsive.isDesktop()),c(),s("ngIf",i.responsive.isDesktop()),c(4),s("matHeaderRowDef",i.displayedColumns),c(),s("matRowDefColumns",i.displayedColumns),c(3),_e(" Showing ",(i.service.currentPage()-1)*i.service.pageSize()+1," to ",(i.service.currentPage()-1)*i.service.pageSize()+i.service.paginatedSubcategories().length," of ",i.service.filteredSubcategories().length," entries "),c(2),s("disabled",i.service.currentPage()===1),c(2),s("ngIf",!i.isMobile)("ngIfElse",e),c(3),s("disabled",i.service.currentPage()===i.service.totalPages()||i.service.totalPages()===0)}}var pa=(()=>{class t{service=w(St);categoryService=w(pt);dialog=w(dt);responsive=w(Ve);darkModeService=w(Le);editingSubcategory=null;selectedSubcategories=[];displayedColumns=[];sortField=null;sortDirection="asc";isMobile=!1;isTablet=!1;breakpointSubscription;categories=[];selectedCategoryId=null;paginator;ngOnInit(){this.breakpointSubscription=this.responsive.currentBreakpoint().subscribe(e=>{this.isMobile=e==="xsmall",this.isTablet=e==="small"||e==="medium",this.updateDisplayedColumns()}),this.darkModeService.applyTheme(),this.categoryService.getCategories(),this.categories=this.categoryService.categories(),this.service.getSubcategories()}ngOnDestroy(){this.breakpointSubscription?.unsubscribe()}updateDisplayedColumns(){this.isMobile?this.displayedColumns=["name","icon","actions"]:this.isTablet?this.displayedColumns=["select","name","icon","imageUrl","CategoryName","actions"]:this.displayedColumns=["select","name","icon","imageUrl","CategoryName","createdAt","modifiedAt","comments","actions"]}onCategoryChange(e){this.selectedCategoryId=e,this.service.setSelectedCategoryId(e),this.selectedSubcategories=[]}refreshTable(){this.sortField=null,this.sortDirection="asc",this.service.sortSubcategories(null,"asc"),this.service.setPage(1),this.service.setSearchQuery(""),this.selectedSubcategories=[];let e=document.getElementById("searchSubcategories");e&&(e.value=""),this.service.getSubcategories()}openAddSubcategoryDialog(){if(!this.selectedCategoryId||!this.categories.find(n=>n.id===this.selectedCategoryId)){console.warn("Please select a valid category.");return}let e=this.isMobile?"90vw":this.isTablet?"80vw":"800px",i=this.categories.find(n=>n.id===this.selectedCategoryId);this.dialog.open(le,{width:e,maxWidth:"100vw",data:{categoryId:this.selectedCategoryId,CategoryName:i.name}}).afterClosed().subscribe(n=>n&&this.service.addSubcategory(n))}startEdit(e){this.editingSubcategory=k({},e);let i=this.isMobile?"90vw":this.isTablet?"80vw":"800px";this.dialog.open(le,{width:i,maxWidth:"100vw",data:{subcategory:this.editingSubcategory,categoryId:e.categoryId,CategoryName:e.CategoryName}}).afterClosed().subscribe(n=>{n&&this.service.updateSubcategory(n),this.editingSubcategory=null})}onSearchQueryChange(e){let i=e.target;this.service.setSearchQuery(i.value)}onPageChange(e){this.service.setPage(e.page+1),this.selectedSubcategories=[]}sortColumn(e,i){this.sortField=e,this.sortDirection=i,this.service.sortSubcategories(this.sortField,this.sortDirection)}toggleSubcategory(e){let i=this.selectedSubcategories.findIndex(n=>n.id===e.id);i===-1?this.selectedSubcategories.push(e):this.selectedSubcategories.splice(i,1)}isSelected(e){return this.selectedSubcategories.some(i=>i.id===e.id)}toggleAllSubcategories(e){e?this.selectedSubcategories=[...this.service.paginatedSubcategories()]:this.selectedSubcategories=[]}isAllSelected(){return this.service.paginatedSubcategories().length>0&&this.service.paginatedSubcategories().every(e=>this.isSelected(e))}deleteSelectedSubcategories(){this.selectedSubcategories.forEach(e=>this.deleteSubcategory(e.id)),this.selectedSubcategories=[]}deleteSubcategory(e){this.service.deleteSubcategory(e)}getPageNumbers(){let e=this.service.totalPages(),i=this.service.currentPage(),n=this.isMobile?3:this.isTablet?4:5,m=Math.max(1,i-Math.floor(n/2)),f=Math.min(e,m+n-1);f-m+1<n&&(m=Math.max(1,f-n+1));let v=[];if(e>0)for(let E=m;E<=f;E++)v.push(E);return v}trackById(e,i){return i.id}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=O({type:t,selectors:[["app-subcategories"]],viewQuery:function(i,n){if(i&1&&de(lt,5),i&2){let m;ge(m=ue())&&(n.paginator=m.first)}},decls:27,vars:11,consts:[["mobilePagination",""],["nameSortMenu","matMenu"],["categorySortMenu","matMenu"],["createdAtSortMenu","matMenu"],["modifiedAtSortMenu","matMenu"],["mobileActions",""],["actionMenu","matMenu"],["noPages",""],[1,"shadow-3xl","rounded-8",2,"font-family","'Roboto, sans-serif'"],[1,"w-64","mx-auto","block","p-4"],["aria-label","Category",3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"relative","flex","items-center","justify-between","flex-col","md:flex-row","gap-4",2,"background-color","#2c3e50","color","#f7f7f7","font-family","'Roboto, sans-serif'","padding","16px"],[1,"flex","items-center"],[1,"text-20","font-semibold","m-0",2,"font-family","'Roboto, sans-serif'"],[1,"flex","items-center","w-full","md:w-1/3","gap-2"],["id","searchSubcategories","type","text","placeholder","Search subcategories...","aria-label","Search subcategories",1,"p-2","border","rounded","text-sm","w-full","focus:outline-none","h-9",2,"font-family","'Roboto, sans-serif'","border-color","#ced4da","background-color","#fff",3,"input"],[1,"flex","gap-2"],["mat-raised-button","","aria-label","Delete selected subcategories",1,"px-4","py-2","text-14","flex","items-center",2,"background-color","#dc3545","color","white","font-family","'Roboto, sans-serif'",3,"click","disabled"],["mat-raised-button","","aria-label","Add new subcategory",1,"px-4","py-2","text-14","flex","items-center",2,"background-color","#28a745","color","white","font-family","'Roboto, sans-serif'",3,"click"],[1,"relative",2,"font-family","'Roboto, sans-serif'"],["class","mb-16 p-16 rounded-8","style","color: var(--mat-sys-error); background-color: color-mix(in srgb, var(--mat-sys-error), transparent 90%); font-family: 'Roboto, sans-serif';","role","alert",4,"ngIf"],["class","text-center mb-16",4,"ngIf"],["class","table-container",3,"dark-theme",4,"ngIf"],["role","alert",1,"mb-16","p-16","rounded-8",2,"color","var(--mat-sys-error)","background-color","color-mix(in srgb, var(--mat-sys-error), transparent 90%)","font-family","'Roboto, sans-serif'"],[1,"text-center","mb-16"],["diameter","40",2,"color","var(--mat-sys-on-surface)"],[1,"table-container"],["role","grid",1,"w-full",3,"dataSource"],["matColumnDef","select",4,"ngIf"],["matColumnDef","name"],["class","p-8 text-16 flex items-center","style","font-family: 'Roboto, sans-serif';","data-label","Name",4,"matHeaderCellDef"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Name",4,"matCellDef"],["matColumnDef","icon"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Icon",4,"matHeaderCellDef"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Icon",4,"matCellDef"],["matColumnDef","imageUrl",4,"ngIf"],["matColumnDef","CategoryName",4,"ngIf"],["matColumnDef","createdAt",4,"ngIf"],["matColumnDef","modifiedAt",4,"ngIf"],["matColumnDef","comments",4,"ngIf"],["matColumnDef","actions"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Actions",4,"matHeaderCellDef"],["class","p-8","data-label","Actions",4,"matCellDef"],["class","divide-y table-header",4,"matHeaderRowDef"],["class","divide-y table-row",4,"matRowDef","matRowDefColumns"],[1,"flex","justify-between","items-center","p-4","pagination-container",2,"color","var(--mat-sys-on-surface)","font-family","'Roboto, sans-serif'"],[1,"text-12"],[1,"flex","gap-4","items-center"],["mat-button","","aria-label","Previous page",1,"px-4","py-2","rounded-4","pagination-button",2,"color","var(--mat-sys-on-surface)","font-family","'Roboto, sans-serif'",3,"click","disabled"],[4,"ngIf","ngIfElse"],["mat-button","","aria-label","Next page",1,"px-4","py-2","rounded-4","pagination-button",2,"color","var(--mat-sys-on-surface)","font-family","'Roboto, sans-serif'",3,"click","disabled"],["matColumnDef","select"],["class","p-8","data-label","Select",4,"matHeaderCellDef"],["class","p-8","data-label","Select",4,"matCellDef"],["data-label","Select",1,"p-8"],["aria-label","Select all subcategories",3,"change","checked","indeterminate"],["aria-label","Select subcategory",3,"change","checked"],["data-label","Name",1,"p-8","text-16","flex","items-center",2,"font-family","'Roboto, sans-serif'"],["mat-icon-button","","aria-label","Sort name",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-icon-button","","aria-label","Sort name",3,"matMenuTriggerFor"],[2,"color","var(--mat-sys-primary)"],["data-label","Name",1,"p-8","text-16",2,"font-family","'Roboto, sans-serif'"],["data-label","Icon",1,"p-8","text-16",2,"font-family","'Roboto, sans-serif'"],["matColumnDef","imageUrl"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Image",4,"matHeaderCellDef"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Image",4,"matCellDef"],["data-label","Image",1,"p-8","text-16",2,"font-family","'Roboto, sans-serif'"],["alt","Subcategory Image","class","w-24 h-24 object-cover rounded",3,"src",4,"ngIf"],["alt","Subcategory Image",1,"w-24","h-24","object-cover","rounded",3,"src"],["matColumnDef","CategoryName"],["class","p-8 text-16 flex items-center","style","font-family: 'Roboto, sans-serif';","data-label","Category",4,"matHeaderCellDef"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Category",4,"matCellDef"],["data-label","Category",1,"p-8","text-16","flex","items-center",2,"font-family","'Roboto, sans-serif'"],["mat-icon-button","","aria-label","Sort category",3,"matMenuTriggerFor",4,"ngIf"],["mat-icon-button","","aria-label","Sort category",3,"matMenuTriggerFor"],["data-label","Category",1,"p-8","text-16",2,"font-family","'Roboto, sans-serif'"],["matColumnDef","createdAt"],["class","p-8 text-16 flex items-center","style","font-family: 'Roboto, sans-serif';","data-label","Created At",4,"matHeaderCellDef"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Created At",4,"matCellDef"],["data-label","Created At",1,"p-8","text-16","flex","items-center",2,"font-family","'Roboto, sans-serif'"],["mat-icon-button","","aria-label","Sort created at",3,"matMenuTriggerFor",4,"ngIf"],["mat-icon-button","","aria-label","Sort created at",3,"matMenuTriggerFor"],["data-label","Created At",1,"p-8","text-16",2,"font-family","'Roboto, sans-serif'"],["matColumnDef","modifiedAt"],["class","p-8 text-16 flex items-center","style","font-family: 'Roboto, sans-serif';","data-label","Modified At",4,"matHeaderCellDef"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Modified At",4,"matCellDef"],["data-label","Modified At",1,"p-8","text-16","flex","items-center",2,"font-family","'Roboto, sans-serif'"],["mat-icon-button","","aria-label","Sort modified at",3,"matMenuTriggerFor",4,"ngIf"],["mat-icon-button","","aria-label","Sort modified at",3,"matMenuTriggerFor"],["data-label","Modified At",1,"p-8","text-16",2,"font-family","'Roboto, sans-serif'"],["matColumnDef","comments"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Comments",4,"matHeaderCellDef"],["class","p-8 text-16","style","font-family: 'Roboto, sans-serif';","data-label","Comments",4,"matCellDef"],["data-label","Comments",1,"p-8","text-16",2,"font-family","'Roboto, sans-serif'"],["data-label","Actions",1,"p-8","text-16",2,"font-family","'Roboto, sans-serif'"],["mat-icon-button","","aria-label","Refresh table",3,"click"],["data-label","Actions",1,"p-8"],["mat-icon-button","","aria-label","Edit subcategory",1,"edit-button",3,"click"],["mat-icon-button","","aria-label","Delete subcategory",1,"delete-button",3,"click"],["mat-icon-button","","aria-label","Subcategory actions",3,"matMenuTriggerFor"],["mat-menu-item","","aria-label","Edit subcategory",3,"click"],["mat-menu-item","","aria-label","Delete subcategory",3,"click"],[1,"divide-y","table-header"],[1,"divide-y","table-row"],["mat-button","","class","px-4 py-2 rounded-4 pagination-button",3,"bg-blue-600","color","background-color","click",4,"ngFor","ngForOf"],["mat-button","",1,"px-4","py-2","rounded-4","pagination-button",3,"click"],[1,"text-sm"],["aria-label","Select page",1,"w-20","p-auto",3,"selectionChange","value"],["disabled","",4,"ngIf"],["disabled",""]],template:function(i,n){i&1&&(o(0,"mat-card",8)(1,"mat-form-field",9)(2,"mat-label"),l(3,"Category"),r(),o(4,"mat-select",10),be("ngModelChange",function(f){return fe(n.selectedCategoryId,f)||(n.selectedCategoryId=f),f}),u("ngModelChange",function(f){return n.onCategoryChange(f)}),o(5,"mat-option",11),l(6,"All"),r(),g(7,Et,2,2,"mat-option",12),r()(),o(8,"mat-card-header",13)(9,"mat-card-title",14)(10,"h2",15),l(11,"Subcategories"),r()(),o(12,"div",16)(13,"input",17),u("input",function(f){return n.onSearchQueryChange(f)}),r()(),o(14,"div",18)(15,"button",19),u("click",function(){return n.deleteSelectedSubcategories()}),o(16,"mat-icon"),l(17,"delete"),r(),l(18," Delete "),r(),o(19,"button",20),u("click",function(){return n.openAddSubcategoryDialog()}),o(20,"mat-icon"),l(21,"add"),r(),l(22," Add Subcategory "),r()()(),o(23,"mat-card-content",21),g(24,kt,2,1,"div",22)(25,Dt,2,0,"div",23)(26,xi,30,18,"div",24),r()()),i&2&&(c(4),pe("ngModel",n.selectedCategoryId),c(),s("value",null),c(2),s("ngForOf",n.categories),c(8),s("disabled",!n.selectedSubcategories.length),c(),H("color","#FFFFFF"),c(4),H("color","#FFFFFF"),c(4),s("ngIf",n.service.error()),c(),s("ngIf",n.service.isLoading()),c(),s("ngIf",!n.service.isLoading()))},dependencies:[q,Se,j,ye,Pe,Y,Ee,at,Je,Ge,Ze,Ke,We,et,Xe,Ye,tt,it,K,G,Ce,te,ee,Z,ie,ct,X,gt,_t,ut,W,B,z,J,Q,ze,Qe,Ie,ve,he,Me,rt,ot,nt],encapsulation:2})}return t})();export{pa as SubcategoriesComponent};
//# sourceMappingURL=subcategories.component-2CVW4XWP.js.map
