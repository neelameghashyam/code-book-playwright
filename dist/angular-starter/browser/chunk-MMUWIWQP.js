import{a as o,b as L,c as I,d as P,e as D,f as O}from"./chunk-7GDRIGFI.js";import{Kc as n,a as m,b as u,ba as y,ga as w}from"./chunk-ZH2ICRTR.js";var U={categories:[],initialized:!1,error:null,currentPage:1,pageSize:10,searchQuery:"",isLoading:!1,sortField:null,sortDirection:"asc"},A=L({providedIn:"root"},O(U),I(({categories:r,searchQuery:e,currentPage:t,pageSize:a,isLoading:s,error:i,sortField:C,sortDirection:h})=>{let f=n(()=>{let g=r().filter(c=>String(c.name||"").toLowerCase().includes(e().toLowerCase())||String(c.icon||"").toLowerCase().includes(e().toLowerCase())||String(c.comments||"").toLowerCase().includes(e().toLowerCase()));return C()&&(g=g.sort((c,p)=>{let l=C();if(l==="createdAt"||l==="modifiedAt"){let d=new Date(c[l]||"").getTime(),S=new Date(p[l]||"").getTime();return h()==="asc"?d-S:S-d}else{let d=String(c[l]||"").toLowerCase(),S=String(p[l]||"").toLowerCase();return h()==="asc"?d.localeCompare(S):S.localeCompare(d)}})),g});return{categories:n(()=>r()),filteredCategories:f,paginatedCategories:n(()=>{let g=(t()-1)*a();return f().slice(g,g+a())}),totalPages:n(()=>Math.ceil(f().length/a())),currentPage:n(()=>t()),pageSize:n(()=>a()),isLoading:n(()=>s()),error:n(()=>i())}}),D(r=>({loadCategories(){try{o(r,{isLoading:!0,error:null});let e=localStorage.getItem("categories"),t=[];e&&(t=JSON.parse(e).map(a=>u(m({},a),{name:String(a.name||""),icon:String(a.icon||""),imageUrl:String(a.imageUrl||""),createdAt:String(a.createdAt||new Date().toISOString()),modifiedAt:String(a.modifiedAt||new Date().toISOString()),comments:String(a.comments||"")}))),o(r,{categories:t,initialized:!0,isLoading:!1,error:null})}catch(e){let t=e.message||"Failed to load categories";throw o(r,{error:t,isLoading:!1}),e}},addCategory(e){try{o(r,{isLoading:!0,error:null});let t=u(m({},e),{id:Date.now(),createdAt:new Date().toISOString(),modifiedAt:new Date().toISOString(),name:String(e.name||""),icon:String(e.icon||""),imageUrl:String(e.imageUrl||""),comments:String(e.comments||"")}),a=localStorage.getItem("categories"),s=a?JSON.parse(a):[];return s.push(t),localStorage.setItem("categories",JSON.stringify(s)),o(r,{categories:[...r.categories(),t],isLoading:!1,error:null}),t}catch(t){let a=t.message||"Failed to add category";throw o(r,{error:a,isLoading:!1}),t}},updateCategory(e){try{o(r,{isLoading:!0,error:null});let t=localStorage.getItem("categories");if(t){let s=JSON.parse(t).map(i=>i.id===e.id?u(m({},e),{modifiedAt:new Date().toISOString(),name:String(e.name||""),icon:String(e.icon||""),imageUrl:String(e.imageUrl||""),comments:String(e.comments||"")}):i);localStorage.setItem("categories",JSON.stringify(s)),o(r,{categories:r.categories().map(i=>i.id===e.id?u(m({},e),{modifiedAt:new Date().toISOString(),name:String(e.name||""),icon:String(e.icon||""),imageUrl:String(e.imageUrl||""),comments:String(e.comments||"")}):i),isLoading:!1,error:null})}}catch{}},deleteCategory(e){try{o(r,{isLoading:!0,error:null});let t=localStorage.getItem("categories");if(t){let s=JSON.parse(t).filter(i=>i.id!==e);localStorage.setItem("categories",JSON.stringify(s)),o(r,{categories:r.categories().filter(i=>i.id!==e),isLoading:!1,error:null})}}catch{}},setPage(e){o(r,{currentPage:e})},setPageSize(e){o(r,{pageSize:e,currentPage:1})},setSearchQuery(e){o(r,{searchQuery:e,currentPage:1})},sortCategories(e,t){o(r,{sortField:e,sortDirection:t,currentPage:1})}})),P({onInit(r){r.loadCategories()}}));var k=(()=>{class r{categoryStore=w(A);categories=this.categoryStore.categories;filteredCategories=this.categoryStore.filteredCategories;paginatedCategories=this.categoryStore.paginatedCategories;totalPages=this.categoryStore.totalPages;currentPage=this.categoryStore.currentPage;pageSize=this.categoryStore.pageSize;isLoading=this.categoryStore.isLoading;error=this.categoryStore.error;getCategories(){return this.categoryStore.loadCategories()}addCategory(t){return this.categoryStore.addCategory(t)}updateCategory(t){return this.categoryStore.updateCategory(t)}deleteCategory(t){return this.categoryStore.deleteCategory(t)}setPage(t){this.categoryStore.setPage(t)}setPageSize(t){this.categoryStore.setPageSize(t)}setSearchQuery(t){this.categoryStore.setSearchQuery(t)}sortCategories(t,a){this.categoryStore.sortCategories(t,a)}static \u0275fac=function(a){return new(a||r)};static \u0275prov=y({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();export{k as a};
//# sourceMappingURL=chunk-MMUWIWQP.js.map
